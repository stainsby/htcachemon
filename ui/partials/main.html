<div class="row-fluid clearfix">
  <div class="col-md-12">
    <h4>Cache Entries</h4>
    <form ng-submit="applyUrlFilter()">
      <label>Filter URLs: <input type="text"></label>
    </form>
  </div>
</div>

<hr>

<div class="row-fluid clearfix">
  <div class="col-md-12">

    <div ng-hide="loaded" class="alert alert-info"><p>Fetching cache entries ...</p></div>

    <ul ng-show="loaded" ng-init="entryShowState = {}" class="list-group">
      <li class="list-group-item" ng-repeat="(url, stats) in entries">
        <button class="pull-right btn btn-sm btn-warning"><i class="fa fa-trash"></i>&nbsp;purge</button>
        <p>
          <a ng-href="{{url}}" target="_blank">{{url}}</a>
          {{stats.length}} entr{{stats.length > 1 && 'ies' || 'y'}}
          <a ng-click="entryShowState[$index] = !entryShowState[$index]" href="">
            <i class="fa" ng-class="entryShowState[$index] && 'fa-chevron-down' || 'fa-chevron-right'"></i>
          </a>
        </p>
        <div ng-if="entryShowState[$index]" class="ng-fade">
          <p ng-repeat="stat in stats">
            <strong>{{stat.status}} {{status[stat.status]}}, {{moment(stat.requestTime).format('DD MMM YYYY, HH:mm:ss.SSS[s]')}}</strong><br>
            expires: {{moment(stat.expiry).format('DD MMM YYYY, HH:mm:ss')}} ({{moment(stat.expiry).fromNow()}})<br>
            size: {{filesize(stat.bodySize)}}<br>
            version: {{stat.entityVersion}}<br>
            responded: {{moment(stat.responseTime).format('DD MMM YYYY, HH:mm:ss.SSS[s]')}}<br>
          </p>
        </div>
      </li>
    </ul>

  </div>
</div>
